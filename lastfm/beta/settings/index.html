<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Settings | NekoFM</title>
    <meta name="author" content="Lel Illumina" />
    <meta name="description" content="Change view settings for NekoFM" />
    <meta name="keywords" content="Nekoweb, LastFM, NekoFM, Music" />
    <meta property="og:title" content="Settings | NekoFM" />
    <meta property="og:description" content="Change view settings for NekoFM" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://lel.nekoweb.org/lastfm/settings" />
    <meta property="og:site_name" content="Nekoweb Lel" />
    <meta
      property="og:image"
      content="https://lel.nekoweb.org/images/NekoFM_ek.png"
    />
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "url": "https://lel.nekoweb.org/lastfm/settings",
        "name": "Settings | NekoFM",
        "author": {
          "@type": "Person",
          "name": "Lel Illumina"
        }
      }
    </script>
    <meta name="theme-color" content="#a20000" />
    <link rel="apple-touch-icon" href="/images/NekoFM_ek.png" />
    <link rel="preconnect" href="https://lastfm.freetls.fastly.net" />
    <link rel="icon" type="image/x-icon" href="/images/NekoFM_ek.png" />
    <link rel="stylesheet" href="../style.css" />
    <style>
      p,
      label {
        font-family: "JetBrains Mono", "Courier New", courier, monospace;
        line-height: 30px;
      }
      #form {
        margin: 25px 10%;
      }
    </style>
  </head>
  <body>
    <header>
      <div id="title">
        <a href="/lastfm/beta"
          ><img id="logo" src="/images/NekoFM.png" alt="NekoFM" />
          <h2 style="display: inline">Beta</h2></a
        >
        <nav id="navbar">
          <ul>
            <li><a href="../css">Custom CSS</a></li>
            <li><a href="../settings">Settings</a></li>
          </ul>
        </nav>
        <h2 id="tagline">Settings</h2>
      </div>
    </header>
    <div>
      <main>
        <div id="form">
          <h2>Settings</h2>
          <label for="nsfw">NSFW Album Covers:</label>
          <br />
          <label for="nsfw-removed">
            <input
              type="radio"
              id="nsfw-removed"
              name="nsfw"
              value="removed"
              checked
            />
            Removed
          </label>
          <br />
          <label for="nsfw-blurred">
            <input type="radio" id="nsfw-blurred" name="nsfw" value="blurred" />
            Blurred
          </label>
          <br />
          <label for="nsfw">
            <input type="radio" id="nsfw" name="nsfw" value="off" />
            Show
          </label>
          <br /><br />
          <label for="customCSS">Custom CSS:</label>
          <input
            type="checkbox"
            id="customCSS"
            name="customCSS"
            checked
          /><br /><br />
          <input type="submit" value="Save" onclick="submit()" />
          <input
            type="reset"
            value="Delete Cookies"
            onclick="deleteCookies(); alert('Cookies Cleared')"
          />
        </div>
      </main>
    </div>
    <script>
      function deleteCookies() {
        var cookies = document.cookie.split(";");

        for (var i = 0; i < cookies.length; i++) {
          var cookie = cookies[i];
          var eqPos = cookie.indexOf("=");
          var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
          document.cookie =
            name +
            "=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/; SameSite=Lax";
        }
      }

      function setCookie() {
        deleteCookies();
        let nsfwValue;
        let cssEnabled = document.getElementById("customCSS").checked;
        const nsfwRadios = document.getElementsByName("nsfw");

        // Find the selected NSFW option
        for (let i = 0; i < nsfwRadios.length; i++) {
          if (nsfwRadios[i].checked) {
            nsfwValue = nsfwRadios[i].value;
            break;
          }
        }

        // Store the values in cookies with SameSite attribute
        document.cookie =
          "nsfw=" +
          nsfwValue +
          "; expires=Fri, 31 Dec 9999 23:59:59 UTC; path=/; SameSite=Lax";
        document.cookie =
          "customCSS=" +
          cssEnabled +
          "; expires=Fri, 31 Dec 9999 23:59:59 UTC; path=/; SameSite=Lax";
      }

      function submit() {
        try {
          setCookie();
          alert("Settings successfully saved");
        } catch (error) {
          alert("Error: " + error.message);
        }
      }
    </script>
  </body>
</html>
